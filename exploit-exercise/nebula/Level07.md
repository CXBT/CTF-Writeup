# Level 07

## Plot

### About

The flag07 user was writing their very first perl program that allowed them to ping hosts to see if they were reachable from the web server.

To do this level, log in as the level07 account with the password level07. Files for this level can be found in /home/flag07.

### Source code

```perl
#!/usr/bin/perl

use CGI qw{param};

print "Content-type: text/html\n\n";

sub ping {
  $host = $_[0];

  print("<html><head><title>Ping results</title></head><body><pre>");

  @output = `ping -c 3 $host 2>&1`;
  foreach $line (@output) { print "$line"; }

  print("</pre></body></html>");
  
}

# check if Host set. if not, display normal page, etc

ping(param("Host"));
```

`thttpd.conf` 설정파일을 보면 알수 있는데, `flag07`은 포트 7007번에 HTTP서버를 열어 놓고 있다. 웹브라우저나 `curl`로 문제서버 7007 포트로 접속을 하면 확인 할 수 있다. `Host`값을 `GET`으로 보내면 서버는 해당 `Host`로 핑을 한 결과를 클라이언트에게 보내준다.

이때 `index.cgi`에서 `Host`값을 그대로 명령어로 실행을 하는데, 여기서 우리가 원하는 명령어를 더 실행할 수 있게 된다.

> ?Host=127.0.0.1|getflag

위 처럼 `Host`값을 주면 먼저 `ping -c 3 127.0.0.1`을 실행하고 이후 `getflag 2>&1`을 실행하게 된다.

![이렇게 하면 됩니당](screenshot\level07.PNG)