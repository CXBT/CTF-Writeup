# Level 00

## Plot

### About

This level requires you to find a Set User ID program that will run as the “flag00” account. You could also find this by carefully looking in top level directories in / for suspicious looking directories.

Alternatively, look at the find man page.

To access this level, log in as level00 with the password of level00.

### Source code

There is no source code available for this level

## 뭘 하라는 걸까

문제를 잘 읽으면 flag00 계정 권한의 setuid가 걸린 파일을 찾아야 된다는 걸 알 수 있다. `find` 명령어를 쓰면 아주 간편하고 쉽게 찾을 수 있다!

```bash
flag00@nebula:~$ find / -user flag00 -perm /4000 2>&1 | grep -v -e "Permission" -e "No such file ">&2
/bin/.../flag00
/rofs/bin/.../flag00
flag00@nebula:~$ file /bin/.../flag00
/bin/.../flag00: setuid ELF 32-bit LSB executable, Intel 80386, version 1 (SYSV), dynamically linked (uses shared libs), for GNU/Linux 2.6.15, not stripped
flag00@nebula:~$ /bin/.../flag00
Congrats, now run getflag to get your flag!
flag00@nebula:~$ getflag
You have successfully executed getflag on a target account
```

명령어를 분해해서 각각 살펴보도록 하겠다.

> find -user flag00 -perm /4000 2>&1

`find` 뒤의 `-user` 옵션은 말 그대로 파일 소유권을 지닌 유저를 분류하는 거고, `-perm` 옵션은 setuid가 걸린 파일을 찾기 위해 걸어놓은 것이다. 이때 숫자 앞에 `/`를 붙힌 이유는 [setuid가 걸린 모든 파일을 가져오기 위함이다](https://unix.stackexchange.com/questions/180867/how-to-search-for-all-suid-sgid-files).

 `find` 명령어로 얻은 결과를 stderr와 합쳐 stdout으로 다음 명령인 `grep`으로 stdin으로 보내게 된다.

> grep -v -e "Permission" -e "No such file" >&2

`grep`에선 "Permission"과 "No such file"을 가진 라인을 배재하도록 `-v` 옵션을 주었다. `-e` 옵션으로 배재할 패턴을 `"Permission"`과 `"No such file"` 2개 넘겨 주었다.

## 여기서 잠시만, Linux PIPE와 Redirection에 대해 알아보자

파일 디스크립터 0번, 1번, 2번이 각각 `STDIN`, `STDOUT`, `STDERR`에 해당하는 건 모두 다 아는 사실이다. (Pwnable.kr `1 - fd` 참고)

파일 디스크립터를 쉘에서 잘 사용하면 내가 원하는 라인만 쭉쭉 뽑아낼 수 있다! 이 외에도 쉘은 파이프와 리다이렉션이란 걸 지원하는데, 이를 잘 사용하면 프로그램 몇개를 연계시켜서 한 라인으로 모든걸 처리할 수 있게 된다!

### | (Vertical Bar)

이 기호 되게 많이 쓰는데, 공식적인 이름을 써본적이 없는 것 같다. 아스키 코드 사이트에서 찾은 영문 이름은 `vertical bar`로, 한글로 직역하면 `수직 바`, 초월번역하면 `작대기(?!?)` 정도가 될 것 같다. 나도 얘들 알려줄때 작대기라고 했던 것 같다. 가까운 친구에게 물어보다가 생각이 났는데, 이 기호는 수학에서 `바`로 쓰인다! 그래서 그냥 `바`라고 읽으면 될 것 같다ㅋ

본론으로 돌아와서 `|`는 좌측에 있는 명령어의 stdout을 우측 명령어의 stdin으로 리다이렉션 시켜주는 역할을 한다. 예를 들어보자

> ls -al | grep "chunkforge"

`ls`로 현재 디렉토리를 리스팅한 결과를 바로 터미널에 출력하지 않고 `grep`에 입력값으로 넣어주게 된다. `grep`을 거쳐서 "chunkforge"가 포함된 라인만 찾아서 출력하게 된다.

```bash
dsm2018@CXBT:Desktop$ ls -al
total 12
drwxrwxrwx 1 dsm2018 dsm2018  512 Jun 16 02:10 .
drwxrwxrwx 1 dsm2018 dsm2018  512 Jun 15 23:41 ..
drwxrwxrwx 1 dsm2018 dsm2018  512 Jun  4 12:06 취약점분석
drwxrwxrwx 1 dsm2018 dsm2018  512 Jun  8 20:16 awesome-stash
drwxrwxrwx 1 dsm2018 dsm2018  512 Jun 10 22:28 BabelfishForHxD
drwxrwxrwx 1 dsm2018 dsm2018  512 Jun  7 09:42 Binary Analysis
-rwxrwxrwx 1 dsm2018 dsm2018 8768 Jun 16 02:10 chunkforge
-rwxrwxrwx 1 dsm2018 dsm2018  486 Jun 16 02:10 chunkforge.c
drwxrwxrwx 1 dsm2018 dsm2018  512 May 31 10:38 cxbt-dotfile
-rwxrwxrwx 1 dsm2018 dsm2018  282 Jun  8 08:46 desktop.ini
drwxrwxrwx 1 dsm2018 dsm2018  512 Jun 12 14:18 how2heap
drwxrwxrwx 1 dsm2018 dsm2018  512 May 15 22:48 linux-4.16.8
drwxrwxrwx 1 dsm2018 dsm2018  512 Jun 11 10:43 NCS
drwxrwxrwx 1 dsm2018 dsm2018  512 Jun 13 22:18 Writeup
...
dsm2018@CXBT:Desktop$ ls -al | grep "chunkforge"
-rwxrwxrwx 1 dsm2018 dsm2018 8768 Jun 16 02:10 chunkforge
-rwxrwxrwx 1 dsm2018 dsm2018  486 Jun 16 02:10 chunkforge.c
```

### > (오른쪽을 가리키는 화살괄호), < (왼쪽을 가리키는 화살괄호)

`>`는 오른쪽을 가리키는 괄호이다. 보이는 것처럼 왼쪽에 있는 무언가를 오른쪽으로 넘길 때 사용된다.

> ls -al > ls-al.txt

`ls -al`은 stdout으로 디렉토리 리스팅한 결과를 보낸다. 여기서 `>`는 `ls-al.txt` 파일로 stdout 방향을 틀어버리는 역할을 한다.

왼쪽을 가리키는 화살괄호 `<`는 위에서 설명한 것과 정반대의 역할을 한다.